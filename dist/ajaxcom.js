!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ajaxcom=t():e.ajaxcom=t()}(window,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,c)}u((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(5);t.request=function(e){return r(this,void 0,Promise,function(){var t,n;return o(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),[4,e.beforeSend()];case 1:return r.sent(),[4,a.fetchOperations(e)];case 2:return(t=r.sent()).ok?[4,e.success()]:(e.error(t),[2]);case 3:return r.sent(),[4,a.handleOperations(t)];case 4:return r.sent(),e.complete(),[3,6];case 5:return n=r.sent(),e.error(n),[3,6];case 6:return[2]}})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2);t.addFragmentOptions=function(e,t){if(0===t.length)return e;e.headers={"X-AjaxComFragment":t.substring(1)};var n=e.complete;return e.complete=function(){r.scrollToElement(t),n()},e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scrollToElement=function(e){if(!(e.length<1)){var t=document.querySelector(e);null===t&&(t=document.querySelector("[name="+e.substr(1)+"]")),null!==t&&t.scrollIntoView()}}},function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,c)}u((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),c=n(0),u=n(9),l={beforeSend:function(){return Promise.resolve()},complete:function(){},error:function(){alert("Server cannot handle your request. Please try it again or contact the administrator.")},success:function(){return Promise.resolve()}};t.initialize=function(e){var t=r({},l,{formsSelector:"form:not([data-ignore-ajaxcom])",linksSelector:"a:not([target=_blank]):not([data-ignore-ajaxcom])"},e);document.addEventListener("click",i.toHandleClick(t)),document.addEventListener("submit",u.toHandleSubmit(t)),window.onpopstate=function(e){var t=e.target||e.srcElement;t.location.hash&&function(e){return e.location.href.replace(e.location.hash,"")===location.href.replace(location.hash,"")}(t)||("object"==typeof e.state&&null!==e.state||window.location.reload(),window.location.href=e.state.url)}},t.fetch=function(e,t){return o(this,void 0,Promise,function(){var n;return a(this,function(o){return n=r({method:"GET"},l,t,e),c.request(n),[2]})})}},function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=n(0),i=n(2);function c(e){return"A"!==e.tagName.toUpperCase()}function u(e){return e.hostname!==location.hostname||e.protocol!==location.protocol}function l(e){return e.hash&&e.href.replace(e.hash,"")===location.href.replace(location.hash,"")}function s(e){return e.href===location.href+"#"}t.toHandleClick=function(e){return function(t){var n=function(e){var t=e.target||e.srcElement;return c(t)?t.parentElement:t}(t);if(n.matches("[href^='#']"))return t.preventDefault(),n.hash&&(window.location.hash=n.hash),void i.scrollToElement(n.hash);if(n.matches(e.linksSelector)&&!function(e){return e.which>1||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey}(t)&&!function(e){return[c,u,l,s].some(function(t){return t(e)})}(n)){t.preventDefault();var f=r({},e,{method:"GET",url:n.href});a.request(o.addFragmentOptions(f,n.hash))}}}},function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n(6),a=n(7),i=n(8);t.fetchOperations=function(e){return fetch(e.url,{body:e.body,cache:"no-store",credentials:"include",headers:new Headers(r({},e.headers,{"X-AjaxCom":"true",Accept:"application/json"})),method:e.method})},t.handleOperations=function(e){return e.json().then(function(e){e.forEach(function(e){return function(e){var t=e.operation,n=e.options;switch(t){case"container":i.handleContainer(n);break;case"changeurl":a.handleChangeUrl(n);break;case"callback":o.handleCallback(n);break;default:throw new Error("Operation "+t+" is not supported")}}(e)})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleCallback=function(e){var t=e.callFunction.split("."),n=window;t.forEach(function(t){if(void 0===n[t])throw new Error('Invalid callback "'+e.callFunction+'"');n=n[t]}),"function"==typeof n&&n(e.params)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleChangeUrl=function(e){var t;switch(e.method){case"push":t=function(e){var t=window.location.href+window.location.search,n=window.location.pathname+window.location.search;t!==e.url&&n!==e.url&&history.pushState(e,null,e.url)}(e);break;case"replace":t=function(e){history.replaceState(e,null,e.url)}(e);break;case"redirect":t=function(e){window.location.href=e.url}(e);break;default:throw new Error("ChangeUrl method "+e.method+" is not supported")}setTimeout(t,e.wait)}},function(e,t,n){"use strict";function r(e){return document.createRange().createContextualFragment(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.handleContainer=function(e){var t=document.querySelectorAll(e.target);if(null!==t){var n,o=Array.from(t);switch(e.method){case"html":o.forEach(function(t){t.innerHTML=e.value});break;case"remove":o.forEach(function(e){e.remove()});break;case"append":n=r(e.value),o.forEach(function(e){e.appendChild(n)});break;case"prepend":!function(){var t=r(e.value);o.forEach(function(e){e.insertBefore(t,e.firstChild)})}();break;case"insertBefore":!function(){var t=r(e.value);o.forEach(function(e){e.parentNode.insertBefore(t,e)})}();break;case"insertAfter":!function(){var t=r(e.value);o.forEach(function(e){e.parentNode.insertBefore(t,e.nextSibling)})}();break;case"replace":o.forEach(function(t){t.outerHTML=e.value});break;case"addClass":o.forEach(function(t){t.classList.add(e.value)});break;case"removeClass":o.forEach(function(t){t.classList.remove(e.value)});break;case"attr":o.forEach(function(t){t.setAttribute(e.attr,e.value)});break;default:throw new Error("Container method "+e.method+" is not supported")}}}},function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,a=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)i.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return i},a=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),c=n(0);t.toHandleSubmit=function(e){return function(t){var n=t.target;if(!1!==n.matches(e.formsSelector)&&"FORM"===n.tagName.toUpperCase()){t.preventDefault();var o=new FormData(n),u=r({},e,{method:n.method,url:n.action?n.action:window.location.href});c.request(function(e,t,n){var o="GET"===e.method.toUpperCase()?function(e,t){var n=a(e.entries()).map(function(e){return encodeURIComponent(e[0])+"="+e[1]}).join("&"),o=-1===t.url.indexOf("?")?"?":"&";return r({},t,{url:[t.url,o,n].join("")})}(t,n):function(e,t){return r({},t,{body:e})}(t,n),c=e.action.indexOf("#");if(c<0)return o;var u=e.action.substring(c);return i.addFragmentOptions(o,u)}(n,o,u))}}}}])});
//# sourceMappingURL=ajaxcom.js.map