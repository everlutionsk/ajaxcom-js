{"version":3,"sources":["webpack://ajaxcom/webpack/universalModuleDefinition","webpack://ajaxcom/webpack/bootstrap","webpack://ajaxcom/./src/handler/request.ts","webpack://ajaxcom/./src/handler/fragmentOptions.ts","webpack://ajaxcom/./src/handler/scroll.ts","webpack://ajaxcom/./src/ajaxcom.ts","webpack://ajaxcom/./src/handler/click.ts","webpack://ajaxcom/./src/handler/operations.ts","webpack://ajaxcom/./src/operation/callback.ts","webpack://ajaxcom/./src/operation/changeUrl.ts","webpack://ajaxcom/./src/operation/container.ts","webpack://ajaxcom/./src/handler/submit.ts"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","operations_1","request","options","Promise","beforeSend","_a","sent","fetchOperations","response","ok","success","error","handleOperations","complete","e_1","scroll_1","addFragmentOptions","fetchOptions","fragment","length","headers","X-AjaxComFragment","substring","completeFunction","scrollToElement","hash","element","document","querySelector","substr","scrollIntoView","click_1","request_1","submit_1","defaultCallbacks","resolve","alert","initialize","ajaxcomOptions","__assign","formsSelector","linksSelector","addEventListener","toHandleClick","toHandleSubmit","onpopstate","event","link","target","srcElement","location","href","replace","hasEmptyHash","state","reload","url","fetch","requestOptions","ajaxcomCallbacks","method","fragmentOptions_1","isNotAnchor","tagName","toUpperCase","isExternalLink","hostname","protocol","isNotAnchorOnSamePage","isAnchorEmpty","parentElement","getLink","matches","preventDefault","which","metaKey","ctrlKey","shiftKey","altKey","isNonAjaxcomCall","some","f","isInvalid","callback_1","changeUrl_1","container_1","body","cache","credentials","Headers","X-AjaxCom","Accept","json","then","data","forEach","operation","handleContainer","handleChangeUrl","handleCallback","Error","handleOperation","namespaces","callFunction","split","context","item","undefined","params","handler","currentUrlHref","search","currentUrlPath","pathname","history","pushState","pushUrl","replaceState","replaceUrl","redirectToUrl","setTimeout","wait","getNodes","html","createRange","createContextualFragment","selection","querySelectorAll","nodes","elements","Array","from","innerHTML","remove","appendChild","insertBefore","firstChild","prepend","parentNode","nextSibling","insertAfter","outerHTML","classList","add","setAttribute","attr","form","formData","FormData","action","query","__spread","entries","map","pair","encodeURIComponent","join","glue","indexOf","fetchOptionsForGet","fetchOptionsForPost","hashPosition","getFetchOptions"],"mappings":"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","file":"ajaxcom.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ajaxcom\"] = factory();\n\telse\n\t\troot[\"ajaxcom\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n","import {IAjaxcomCallbacks} from \"../options/callbacks\";\nimport {IFetchOptions} from \"../options/fetchOptions\";\nimport {fetchOperations, handleOperations} from \"./operations\";\n\nexport async function request(options: Partial<IAjaxcomCallbacks & IFetchOptions>): Promise<void> {\n    try {\n        await options.beforeSend();\n        const response = await fetchOperations(options);\n\n        if (!response.ok) {\n            options.error(response);\n            return;\n        }\n\n        await options.success();\n        await handleOperations(response);\n        options.complete();\n    } catch (e) {\n        options.error(e);\n    }\n}\n","import {IAjaxcomCallbacks} from \"../options/callbacks\";\nimport {IFetchOptions} from \"../options/fetchOptions\";\nimport {scrollToElement} from \"./scroll\";\n\ntype FetchOptions = Partial<IAjaxcomCallbacks & IFetchOptions>;\n\nexport function addFragmentOptions(fetchOptions: FetchOptions, fragment?: string): FetchOptions {\n    if (fragment.length === 0) { return fetchOptions; }\n\n    fetchOptions.headers = {\"X-AjaxComFragment\": fragment.substring(1)};\n\n    const completeFunction = fetchOptions.complete;\n    fetchOptions.complete = () => {\n        scrollToElement(fragment);\n        completeFunction();\n    };\n\n    return fetchOptions;\n}\n","export function scrollToElement(hash: string): void {\n    if (hash.length < 1) { return; }\n\n    let element = document.querySelector(hash);\n    if (null === element) { element = document.querySelector(`[name=${hash.substr(1)}]`); }\n    if (null === element) { return; }\n\n    element.scrollIntoView();\n}\n","import {IAjaxcomCallbacks} from \"options/callbacks\";\nimport {toHandleClick} from \"./handler/click\";\nimport {request} from \"./handler/request\";\nimport {toHandleSubmit} from \"./handler/submit\";\nimport {IFetchOptions} from \"./options/fetchOptions\";\nimport {IAjaxcomSelectors} from \"./options/selectors\";\n\nconst defaultCallbacks = {\n    beforeSend: () => Promise.resolve(),\n    complete: () => undefined,\n    error: onError,\n    success: () => Promise.resolve(),\n};\n\nexport function initialize(options: Partial<IAjaxcomSelectors & IAjaxcomCallbacks>) {\n    const ajaxcomOptions = {\n        ...defaultCallbacks,\n        formsSelector: \"form:not([data-ignore-ajaxcom])\",\n        linksSelector: \"a:not([target=_blank]):not([data-ignore-ajaxcom])\",\n        ...options,\n    };\n\n    document.addEventListener(\"click\", toHandleClick(ajaxcomOptions));\n    document.addEventListener(\"submit\", toHandleSubmit(ajaxcomOptions));\n\n    window.onpopstate = (event: PopStateEvent) => {\n        const link = (event.target || event.srcElement) as Window;\n\n        if (link.location.hash && hasEmptyHash(link)) {\n            return;\n        }\n\n        if (typeof event.state !== \"object\" || event.state === null) {\n            window.location.reload();\n        }\n        window.location.href = event.state.url;\n    };\n\n    function hasEmptyHash(link: Window) {\n        return link.location.href.replace(link.location.hash, \"\") === location.href.replace(location.hash, \"\");\n    }\n}\n\nexport async function fetch(requestOptions: IFetchOptions,\n                            ajaxcomCallbacks: Partial<IAjaxcomCallbacks>): Promise<void> {\n    const options = {\n        method: \"GET\",\n        ...defaultCallbacks,\n        ...ajaxcomCallbacks,\n        ...requestOptions,\n    } as Partial<IAjaxcomCallbacks & IFetchOptions>;\n\n    request(options);\n}\n\nfunction onError() {\n    alert(\"Server cannot handle your request. Please try it again or contact the administrator.\");\n}\n","import {IAjaxcomCallbacks} from \"../options/callbacks\";\nimport {IFetchOptions} from \"../options/fetchOptions\";\nimport {IAjaxcomSelectors} from \"../options/selectors\";\nimport {addFragmentOptions} from \"./fragmentOptions\";\nimport {request} from \"./request\";\nimport {scrollToElement} from \"./scroll\";\n\nexport function toHandleClick(options: Partial<IAjaxcomSelectors &IAjaxcomCallbacks>) {\n    return (event: MouseEvent) => {\n        const link = getLink(event);\n        if (link.matches(\"[href^='#']\")) {\n            event.preventDefault();\n            // Unlike Chrome, in Firefox, window.location.hash = ''; would result in actual appending of '#' to\n            // current URL, which will trigger window.popstate event. From inside our popstate handler we have no\n            // way to detect this and differentiate empty location hash from navigating to current URL (without hash).\n            if (link.hash) {\n                window.location.hash = link.hash;\n            }\n            scrollToElement(link.hash);\n            return;\n        }\n\n        if (!link.matches(options.linksSelector)) { return; }\n        if (isNonAjaxcomCall(event)) { return; }\n        if (isInvalid(link)) { return; }\n\n        event.preventDefault();\n        const fetchOptions = {\n            ...options,\n            method: \"GET\",\n            url: link.href,\n        } as Partial<IAjaxcomCallbacks & IFetchOptions>;\n\n        request(addFragmentOptions(fetchOptions, link.hash));\n    };\n}\n\nfunction isInvalid(link: Element): boolean {\n    return [\n        isNotAnchor,\n        isExternalLink,\n        isNotAnchorOnSamePage,\n        isAnchorEmpty,\n    ].some((f) => f(link));\n}\n\nfunction isNonAjaxcomCall(event: MouseEvent) {\n    return event.which > 1 || event.metaKey || event.ctrlKey || event.shiftKey || event.altKey;\n}\n\nfunction isNotAnchor(link: Element) {\n    return link.tagName.toUpperCase() !== \"A\";\n}\n\nfunction isExternalLink(link: HTMLAnchorElement) {\n    return link.hostname !== location.hostname || link.protocol !== location.protocol;\n}\n\nfunction isNotAnchorOnSamePage(link: HTMLAnchorElement) {\n    return link.hash && link.href.replace(link.hash, \"\") === location.href.replace(location.hash, \"\");\n}\n\nfunction isAnchorEmpty(link: HTMLAnchorElement) {\n    return link.href === location.href + \"#\";\n}\n\nfunction getLink(event: MouseEvent) {\n    const link = (event.target || event.srcElement) as HTMLAnchorElement;\n\n    if (isNotAnchor(link)) {\n        return link.parentElement as HTMLAnchorElement;\n    }\n\n    return link;\n}\n","import {handleCallback} from \"../operation/callback\";\nimport {handleChangeUrl} from \"../operation/changeUrl\";\nimport {handleContainer} from \"../operation/container\";\nimport {IOperationOptions} from \"../operation/options/operationOptions\";\nimport {IAjaxcomCallbacks} from \"../options/callbacks\";\nimport {IFetchOptions} from \"../options/fetchOptions\";\n\nexport function fetchOperations(options: Partial<IAjaxcomCallbacks & IFetchOptions>): Promise<Response> {\n    return fetch(options.url, {\n        body: options.body,\n        cache: \"no-store\",\n        credentials: \"include\",\n        headers: new Headers({...options.headers, \"X-AjaxCom\": \"true\", \"Accept\": \"application/json\"}),\n        method: options.method,\n    });\n}\n\nexport function handleOperations(response: Response): Promise<any> {\n    return response\n        .json()\n        .then((data: IOperationOptions[]) => {\n            data.forEach((operation) => handleOperation(operation));\n        });\n}\n\nfunction handleOperation({operation, options}: IOperationOptions) {\n    switch (operation) {\n        case \"container\":\n            handleContainer(options);\n            break;\n        case \"changeurl\":\n            handleChangeUrl(options);\n            break;\n        case \"callback\":\n            handleCallback(options);\n            break;\n        default:\n            throw new Error(\"Operation \" + operation + \" is not supported\");\n    }\n}\n","import {ICallbackOptions} from \"./options/callbackOptions\";\n\nexport function handleCallback(options: ICallbackOptions) {\n    const namespaces = options.callFunction.split(\".\");\n    let context: any = window;\n\n    namespaces.forEach((item) => {\n        if (context[item] === undefined) {\n            throw new Error('Invalid callback \"' + options.callFunction + '\"');\n        }\n        context = context[item];\n    });\n\n    if (typeof context === \"function\") {\n        context(options.params);\n    }\n}\n","import {IChangeUrlOptions} from \"./options/changeUrlOptions\";\n\nexport function handleChangeUrl(options: IChangeUrlOptions) {\n    let handler;\n\n    switch (options.method) {\n        case \"push\":\n            handler = pushUrl(options);\n            break;\n        case \"replace\":\n            handler = replaceUrl(options);\n            break;\n        case \"redirect\":\n            handler = redirectToUrl(options);\n            break;\n        default:\n            throw new Error(\"ChangeUrl method \" + options.method + \" is not supported\");\n    }\n\n    setTimeout(handler, options.wait);\n}\n\nfunction pushUrl(options: IChangeUrlOptions) {\n    const currentUrlHref = window.location.href + window.location.search;\n    const currentUrlPath = window.location.pathname + window.location.search;\n\n    if (currentUrlHref === options.url || currentUrlPath === options.url) { return; }\n\n    history.pushState(options, null, options.url);\n}\n\nfunction replaceUrl(options: IChangeUrlOptions) {\n    history.replaceState(options, null, options.url);\n}\n\nfunction redirectToUrl(options: IChangeUrlOptions) {\n    window.location.href = options.url;\n}\n","import {IContainerOptions} from \"./options/containerOptions\";\n\nexport function handleContainer(options: IContainerOptions) {\n    const selection = document.querySelectorAll(options.target);\n\n    // if elements are not present in DOM just ignore the handler\n    if (selection === null) {\n        return;\n    }\n\n    const elements = Array.from(selection) as Element[];\n\n    function html() {\n        elements.forEach((element) => {\n            element.innerHTML = options.value;\n        });\n    }\n\n    function remove() {\n        elements.forEach((element) => {\n            element.remove();\n        });\n    }\n\n    function append() {\n        const nodes = getNodes(options.value);\n        elements.forEach((element) => {\n            element.appendChild(nodes);\n        });\n    }\n\n    function prepend() {\n        const nodes = getNodes(options.value);\n        elements.forEach((element) => {\n            element.insertBefore(nodes, element.firstChild);\n        });\n    }\n\n    function insertBefore() {\n        const nodes = getNodes(options.value);\n        elements.forEach((element) => {\n            element.parentNode.insertBefore(nodes, element);\n        });\n    }\n\n    function insertAfter() {\n        const nodes = getNodes(options.value);\n        elements.forEach((element) => {\n            element.parentNode.insertBefore(nodes, element.nextSibling);\n        });\n    }\n\n    function replace() {\n        elements.forEach((element) => {\n            element.outerHTML = options.value;\n        });\n    }\n\n    function addClass() {\n        elements.forEach((element) => {\n            element.classList.add(options.value);\n        });\n    }\n\n    function removeClass() {\n        elements.forEach((element) => {\n            element.classList.remove(options.value);\n        });\n    }\n\n    function attr() {\n        elements.forEach((element) => {\n            element.setAttribute(options.attr, options.value);\n        });\n    }\n\n    switch (options.method) {\n        case \"html\":\n            html();\n            break;\n        case \"remove\":\n            remove();\n            break;\n        case \"append\":\n            append();\n            break;\n        case \"prepend\":\n            prepend();\n            break;\n        case \"insertBefore\":\n            insertBefore();\n            break;\n        case \"insertAfter\":\n            insertAfter();\n            break;\n        case \"replace\":\n            replace();\n            break;\n        case \"addClass\":\n            addClass();\n            break;\n        case \"removeClass\":\n            removeClass();\n            break;\n        case \"attr\":\n            attr();\n            break;\n        default:\n            throw new Error(\"Container method \" + options.method + \" is not supported\");\n    }\n}\n\nfunction getNodes(html: string) {\n    return document.createRange().createContextualFragment(html);\n}\n","import {IAjaxcomCallbacks} from \"../options/callbacks\";\nimport {IFetchOptions} from \"../options/fetchOptions\";\nimport {IAjaxcomSelectors} from \"../options/selectors\";\nimport {addFragmentOptions} from \"./fragmentOptions\";\nimport {request} from \"./request\";\n\nexport function toHandleSubmit(options?: Partial<IAjaxcomSelectors & IAjaxcomCallbacks>) {\n    return (event: Event) => {\n        const form = event.target as HTMLFormElement;\n\n        if (false === form.matches(options.formsSelector)) { return; }\n        if (form.tagName.toUpperCase() !== \"FORM\") { return; }\n        event.preventDefault();\n\n        const formData = new FormData(form);\n        const fetchOptions = {\n            ...options,\n            method: form.method,\n            url: form.action ? form.action : window.location.href,\n        };\n\n        request(getFetchOptions(form, formData, fetchOptions));\n    };\n}\n\nfunction getFetchOptions(form: HTMLFormElement, formData: FormData, fetchOptions: SubmitOptions): SubmitOptions {\n    const options = form.method.toUpperCase() === \"GET\"\n        ? fetchOptionsForGet(formData, fetchOptions)\n        : fetchOptionsForPost(formData, fetchOptions);\n\n    const hashPosition = form.action.indexOf(\"#\");\n\n    if (hashPosition < 0) { return options; }\n\n    const fragment = form.action.substring(hashPosition);\n\n    return addFragmentOptions(options, fragment);\n}\n\ntype SubmitOptions = Partial<IAjaxcomCallbacks & IFetchOptions>;\n\nfunction fetchOptionsForPost(formData: FormData, fetchOptions: SubmitOptions): SubmitOptions {\n    return {\n        ...fetchOptions,\n        body: formData,\n    };\n}\n\nfunction fetchOptionsForGet(formData: any, fetchOptions: SubmitOptions): SubmitOptions {\n    const query = [...formData.entries()].map((pair) => `${encodeURIComponent(pair[0])}=${pair[1]}`).join(\"&\");\n    const glue = fetchOptions.url.indexOf(\"?\") === -1 ? \"?\" : \"&\";\n\n    return {\n        ...fetchOptions,\n        url: [fetchOptions.url, glue, query].join(\"\"),\n    };\n}\n"],"sourceRoot":""}